---
title: React系列（三）：什么是好的自动化测试
tags: tbd
---

什么是好的测试，是我讲测试策略的基本功。这个东西好像要掰开了、揉碎了讲一讲。

## 大纲

* 表达力强
* 支撑重构
  * 测试系统时间



## 内容

那么，什么是有效的自动化测试呢？

* 支撑重构
* 有效留存业务上下文：表达力强

表达力强好理解：

> 🚧从上一篇抄一些过来。

**支撑重构的测试**，其重要性怎么强调都不为过，它是实施自动化测试关键中的关键。不能支撑重构的测试~~还留着过年吗~~，只会让测试变成为了交差而不得不完成的任务，改了代码还得修改测试，甚至我重构实现不改动功能还得修改大范围挂掉的测试。这样的测试妥妥地是实现功能的阻力而不是助力，是无效的自动化测试。那么什么才是有效的、能够支撑重构的测试呢？归纳来说，它必须符合

* 与当前测试相关的功能点变化了/改坏了，当前测试必须失败
* 与当前测试相关的功能点没变化/没改坏，但是内在的实现细节改变了，当前测试必须仍然通过
* 与当前测试无关的功能点变化了/改坏了，当前测试必须仍然通过，必须有其他测试失败

这么说对于没有实践经验的同学来说是挺抽象的。所以我们直接上手来看几个例子。

* 断言细节与测试意图相差太远：不好调试、不好理解、挂了不知道咋回事、留不住业务上下文，除了刷覆盖率，对实际的代码质量、稳定性、后续维护基本是拖后腿的状态。
  * 不做精准断言，满篇都是`expect('一些字符').toBeInTheDocument()`。<有啥问题？①字如果是同样的/过于普遍（比如断言$20应该在页面上，鬼知道这啥意思？再者假设你是这么个应用，月付$20，年付只要$208(-32/↓15%)，你断言月付但其实年付也有$20，你改坏了月付，年付还在呢，测试不会挂，但是你的功能坏了。这就是所谓不支持重构的测试），哪哪都有，起不到测试效果；②看了就生气，测的这是啥；③不支持重构>
  * 断言太多细节，比如某个action有没有dispatch、某个mock是不是第n次被调用的时候是某个参数。<有啥问题？>

> 🚧从代码库里补点例子。

## References 
