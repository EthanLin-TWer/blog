---
title: Reactå•å…ƒæµ‹è¯•æœ€ä½³å®è·µï¼ˆäºŒï¼‰
tags: react unit-test tdd rtl react-testing-library jest design-system
---

æœ‰æ•ˆçš„è‡ªåŠ¨åŒ–æµ‹è¯•æ˜¯ä»»ä½•ä¼ä¸šçº§é¡¹ç›®çš„å¿…é€‰é¡¹å’Œè´¨é‡æ ¹åŸºã€‚è€Œå®è·µå·²ç»è¯æ˜ï¼Œåœ¨å‰ç«¯ä»…åšç»„ä»¶å¼çš„å•å…ƒæµ‹è¯•ä¸å¤Ÿæœ‰æ•ˆã€‚æœ¬æ–‡å°†ä»‹ç»ä¸€ç§æ›´ä¸ºæœ‰æ•ˆçš„å•å…ƒæµ‹è¯•æ–¹å¼ï¼Œè®©æµ‹è¯•èƒ½å¤Ÿæ›´å¥½åœ°æ”¯æ’‘é‡æ„å’Œå¼€å‘ã€‚è¿™å¥—ç»éªŒæ›¾æ”¯æ’‘ç¬”è€…ç»å†çš„ä¸€ä¸ªå¹´åäº¿ç¾å…ƒçº§ã€å†æ—¶äº”å¹´+çš„äº¤æ˜“ç³»ç»Ÿçš„æˆåŠŸè¿è¥å’Œç»´æŠ¤æ¼”è¿›ã€‚

## å¤ªé•¿ä¸è¯»â€”â€”æœ¬æ–‡ä¸­å¿ƒè§‚ç‚¹

æ­£å¦‚æˆ‘åœ¨5å¹´å‰çš„[Reactå•å…ƒæµ‹è¯•ç­–ç•¥åŠè½åœ°][reactå•å…ƒæµ‹è¯•ç­–ç•¥]ä¸­æ‰€è¯´ï¼Œè‡ªåŠ¨åŒ–æµ‹è¯•ï¼Œè€Œä¸”æ˜¯**æœ‰æ•ˆçš„è‡ªåŠ¨åŒ–æµ‹è¯•**ï¼Œ**å¯¹äºä»»ä½•ä¸€ä¸ªä¼ä¸šçº§é¡¹ç›®æ¥è¯´éƒ½æ˜¯å¿…é€‰é¡¹è€Œä¸æ˜¯å¯é€‰é¡¹**ã€‚è¿™æ˜¯ç”±ä¼ä¸šé¡¹ç›®çš„ä¸¤ä¸ªç‰¹ç‚¹å†³å®šçš„ï¼š**äººå‘˜æµåŠ¨ä¸å¯é¿å…**ã€**åº”ç”¨æ¼”è¿›ä¸å¯é¿å…**ã€‚è¿™ä¸¤ç‚¹ä¸å› äººçš„ä¸»è§‚æ„å¿—ä¸ºè½¬ç§»ã€‚åº”ç”¨æ¼”è¿›ï¼Œæ„å‘³ç€æ–°çš„ã€é—ç•™çš„ä¸šåŠ¡å’Œä»£ç ä¼šè¶Šæ¥è¶Šå¤šï¼›äººå‘˜æµåŠ¨ï¼Œæ„å‘³ç€ç‰©ç†ä¸Šä¸å¯èƒ½ä¼šæœ‰ä¸€ä¸ªäººèƒ½é•¿æœŸã€å®Œå…¨åœ°æŒæ¡å•ä¸ªåº”ç”¨çš„æ‰€æœ‰ä¸Šä¸‹æ–‡ã€‚å› æ­¤ï¼Œå¸Œæœ›é€šè¿‡æ‰‹å·¥æµ‹è¯•ï¼ˆå¼€å‘è€…è‡ªæµ‹æˆ–è€…å•ç‹¬çš„QAå›¢é˜Ÿæ‰‹æµ‹ï¼‰çš„æ–¹å¼æ¥ä¿éšœè´¨é‡ï¼Œé¦–å…ˆæ—¢æ˜¯ä½æ•ˆçš„ï¼Œé•¿æœŸæ¥çœ‹ä¹Ÿæ˜¯ä¸å¯èƒ½çš„ã€‚

é‚£ä¹ˆï¼Œæœ‰äº†è‡ªåŠ¨åŒ–æµ‹è¯•å°±å¯ä»¥äº†å—ï¼Ÿç­”æ¡ˆä¹Ÿä¸æ˜¯ã€‚æˆ‘è§è¿‡è®¸å¤šæ— æ•ˆçš„è‡ªåŠ¨åŒ–æµ‹è¯•ï¼Œæœ€ç—›çš„è«è¿‡äºèŠ±è´¹è®¸å¤šç²¾åŠ›å†™äº†æµ‹è¯•ï¼Œå´å‘ç°æµ‹è¯•æ— æ³•æ”¯æ’‘é‡æ„ï¼Œè®¸å¤šç®€å•çš„é‡æ„æ¯”å¦‚Reactç»„ä»¶é‡å‘½åã€æ¬ç§»æ•°æ®åˆ°Contextéƒ½ä¼šæŒ‚è®¸å¤šæµ‹è¯•ï¼Œç›´æ¥å¯¹å¼€å‘æ•ˆèƒ½èµ·è´Ÿä½œç”¨ã€‚å…¶æ¬¡ï¼Œæµ‹è¯•ç¼ºä¹æœ‰è¡¨è¾¾åŠ›ã€æœ‰æ„ä¹‰çš„æ–­è¨€ï¼Œæˆ–è€…æµ‹è¯•çš„æè¿°ä¸æ–­è¨€ä¸çœŸå®ä¸šåŠ¡åœºæ™¯è„±èŠ‚ï¼ˆæµ‹è¯•æ–­è¨€çš„æ˜¯é¡µé¢ä¸Šæœ‰æ²¡æœ‰â€œï¿¥400â€ï¼Œå…³è”çš„ä¸šåŠ¡åœºæ™¯å´æ˜¯æŠ¥ä»·èƒ½å¦æˆåŠŸï¼‰ç­‰ç­‰ï¼Œä¹Ÿéƒ½æ˜¯å¸¸è§çš„æ— æ•ˆæµ‹è¯•æ¨¡å¼ã€‚è¿™æ ·çš„æ— æ•ˆæµ‹è¯•ï¼Œéƒ½ä¸èƒ½å¸®åŠ©ä½ ç•™å­˜ä¸šåŠ¡çŸ¥è¯†ã€æ”¯æ’‘éšæ—¶éšåœ°è¿›è¡Œçš„æŠ€æœ¯é‡æ„ï¼Œä¹Ÿæ— æ³•çœŸæ­£åŠ©åŠ›è½¯ä»¶è´¨é‡å’Œç ”å‘æ•ˆèƒ½çš„æå‡ï¼Œä¹…è€Œä¹…ä¹‹åªä¼šè®©æµ‹è¯•å˜æˆä¸€åœºè¡¨æ¼”ï¼Œå˜æˆä¸å¾—ä¸åº”ä»˜è€Œåˆå¼ƒä¹‹å¯æƒœçš„é¸¡è‚‹ã€‚

ä½ éœ€è¦çš„æ˜¯çœŸæ­£**æœ‰æ•ˆçš„è‡ªåŠ¨åŒ–æµ‹è¯•**ã€‚

å¦‚æœä½ æ˜¯ä¼ä¸šçš„ä¸­å±‚æŠ€æœ¯ç®¡ç†è€…ï¼ˆTech Leadæˆ–è€…Technical Principleç­‰ï¼‰ï¼Œé‚£ä¹ˆè¿™æ˜¯ä½ åº”è¯¥å…³æ³¨çš„é—®é¢˜ï¼›å¦‚æœä½ æ˜¯æ­£åœ¨åŠªåŠ›æˆä¸ºæŠ€æœ¯éª¨å¹²çš„å¼€å‘è€…ï¼Œè¿™ç¯‡æ–‡ç« ä¹Ÿæ­£æ˜¯ä¸ºä½ å‡†å¤‡çš„ã€‚

æ¥ä¸‹æ¥ï¼Œæˆ‘ä¼šä»‹ç»ä»€ä¹ˆæ˜¯æœ‰æ•ˆçš„è‡ªåŠ¨åŒ–æµ‹è¯•ï¼Œç„¶åä»¥ä¸€ä¸ªReactåº”ç”¨ä¸ºèƒŒæ™¯ï¼Œä»‹ç»ä¸€ä¸ªå¸¸è§ä¸”æœ‰æ•ˆçš„æµ‹è¯•ç­–ç•¥æ˜¯ä»€ä¹ˆã€ä½œä¸ºå…³é”®éƒ¨åˆ†çš„å•å…ƒæµ‹è¯•åº”è¯¥æ€ä¹ˆæ¶æ„ã€æ€ä¹ˆç¼–å†™ï¼Œæˆ‘ä¼šç»™å‡ºååˆ†å……è¶³çš„ä»£ç æ ·ä¾‹å¸®åŠ©ä½ å’Œä½ çš„å›¢é˜Ÿå»è½åœ°ã€‚æœ€åï¼Œæˆ‘è¿˜ä¼šä»‹ç»è¿™éƒ¨åˆ†å…³é”®çš„å•å…ƒæµ‹è¯•æ–¹å¼æœ‰ä»€ä¹ˆæŒ‘æˆ˜ï¼Œå¸®åŠ©ä½ å¯¹è¿™é¡¹æŠ€æœ¯çŸ¥å·±çŸ¥å½¼ã€‚

è¿™å¥—ç»éªŒæ˜¯æˆ‘åœ¨è¿‡å»ä¸‰å¹´ã€ä¸¤ä¸ªé¡¹ç›®ä¸Šçš„å®è·µå’Œæ€»ç»“ã€‚å®ƒæˆåŠŸåœ°å¸®åŠ©æˆ‘ä»¬èƒ½å¤Ÿåœ¨ä¸€ä¸ªæ”¯æ’‘è¡Œå†…å¹´åäº¿ç¾å…ƒçº§äº¤æ˜“æ•°é¢çš„åº”ç”¨ä¸Šï¼Œå†æ—¶5å¹´+ã€è¿˜æ²¡ä¸ŠTSçš„æƒ…å†µä¸‹ä»èƒ½è‡ªä¿¡åœ°ä¿®æ”¹å’Œé‡æ„ä»£ç ï¼›å®ƒä¹ŸæˆåŠŸåœ°å¸®åŠ©äº†æˆ‘ä»¬å½“å‰çš„é¡¹ç›®ä»0åˆ°1æ­å»ºèµ·æœ‰æ•ˆçš„æµ‹è¯•ç­–ç•¥ï¼Œå¦‚ä»Šä¸€ä¸ªå…·æœ‰å¤æ‚é€»è¾‘çš„é¡µé¢å·²ç»æœ‰4000è¡Œæµ‹è¯•ä»£ç çš„æœ‰æ•ˆè¦†ç›–ã€‚è¿™ç¯‡æ–‡ç« æ˜¯å®è·µä¸­è¯ç”Ÿçš„ç»éªŒå’Œæ€»ç»“ã€‚

èˆå°å·²ç»æ­å¥½ï¼Œä¸‹é¢è®©æˆ‘ä»¬ç›´å¥”ä¸»é¢˜~~ç›´æ¥å¼€æ¼”~~ã€‚

> ğŸš§æ­£æ–‡å†…å®¹æ­£åœ¨æ–½å·¥ä¸­ã€‚

## ç›®å½•

* ä¸ä¸Šä¸€ç‰ˆçš„å˜åŒ–
* ä»€ä¹ˆæ˜¯æ— æ•ˆçš„è‡ªåŠ¨åŒ–æµ‹è¯•ï¼Ÿ
* Reactæ¶æ„ä¸æµ‹è¯•ç­–ç•¥
* æµ‹è¯•æ¶æ„ã€ä»£ç è½åœ°
* æ–°çš„è¡ç”Ÿé—®é¢˜
* æ€»ç»“ï¼šä¼˜åŠ¿ & æŒ‘æˆ˜
* Q & A

> ğŸš§æ­£æ–‡å†…å®¹æ­£åœ¨æ–½å·¥ä¸­ã€‚

## ä¸ä¸Šä¸€ç‰ˆçš„å˜åŒ–

å¦‚æœä½ ä¹‹å‰æœªè¯»è¿‡æˆ‘çš„å‰ä½œ[ã€ŠReactå•å…ƒæµ‹è¯•ç­–ç•¥åŠè½åœ°ã€‹][reactå•å…ƒæµ‹è¯•ç­–ç•¥]ï¼Œé‚£ä¹ˆæœ¬èŠ‚ä½ è‡ªå¯è·³è¿‡ã€‚

å¦‚æœä½ æ˜¯ä¸Šä¸€ç¯‡[ã€ŠReactå•å…ƒæµ‹è¯•ç­–ç•¥åŠè½åœ°ã€‹][reactå•å…ƒæµ‹è¯•ç­–ç•¥]çš„è¯»è€…ï¼Œé‚£ä¹ˆè¿™é‡Œæˆ‘ä¸ºä½ å¿«é€Ÿæ€»ç»“äº†ä¸€ä¸‹æœ¬ç¯‡ç›¸æ¯”äºå‰ç¯‡çš„æ‰¬å¼ƒä¹‹å¤„ï¼Œä»¥ä¾¿ä½ æ›´å¿«åœ°ç†è§£æœ¬ç¯‡çš„æ¶æ„å’Œå†…å®¹ï¼Œå¹¶ç»§ç»­å¸æ”¶ä¸Šä¸€ç¯‡ä¸­çš„ç²¾åéƒ¨åˆ†ã€‚

åœ¨ä¸Šä¸€ç‰ˆä¸­ï¼š

* â€œä¸ºä»€ä¹ˆè¦åš(å•å…ƒ)æµ‹è¯•â€éƒ¨åˆ†æ²¡æœ‰å˜åŒ–ã€‚æœ‰æ•ˆçš„è‡ªåŠ¨åŒ–æµ‹è¯•ä»ç„¶æ˜¯**æ ¹æœ¬çš„è´¨é‡ä¿éšœ**ï¼Œè¿™æ˜¯å› ä¸ºäººå‘˜æµåŠ¨å’Œåº”ç”¨æ¼”è¿›è¿™ä¸¤ä¸ªå› ç´ å¯¹äºä¼ä¸šçº§é¡¹ç›®æ¥è¯´å¹¶æ²¡æœ‰æ”¹å˜ã€‚
* â€œä»€ä¹ˆæ˜¯å¥½çš„(å•å…ƒ)æµ‹è¯•â€è¿™éƒ¨åˆ†ï¼Œä¸Šä¸€ç¯‡æåˆ°çš„â€œä¸åŒ…å«é€»è¾‘â€ã€â€œè¿è¡Œé€Ÿåº¦å¿«â€è¿™ä¸¤ç‚¹åœ¨æœ¬ç¯‡å³å°†ä»‹ç»çš„æµ‹è¯•ç­–ç•¥ä¸‹éœ€è¦*ç›¸å¯¹å¦¥å*ï¼Œç›®çš„æ˜¯ä¸ºäº†æ›´å¥½åœ°æ”¯æ’‘è¿™ä¸ªæ›´æœ¬è´¨çš„è¦æ±‚ï¼šæ”¯æ’‘é‡æ„ã€‚
* â€œ(å•å…ƒ)æµ‹è¯•ç­–ç•¥â€è¿™éƒ¨åˆ†ï¼Œç»™å‡ºäº†ä¸€ä¸ªåŸºäºæ–°Reactèƒ½åŠ›çš„æ¶æ„ï¼Œä»¥åŠä¸ä¹‹å¯¹åº”çš„æ–°çš„æµ‹è¯•ç­–ç•¥ã€‚è¿™ä¸ªæ–°ç­–ç•¥ï¼Œä¸€æ–¹é¢æ˜¯è®©æµ‹è¯•æ›´å¥½åœ°æ”¯æ’‘é‡æ„ï¼Œä¸€æ–¹é¢ä¹Ÿèƒ½åœ¨é—ç•™ç³»ç»Ÿ/ä¹‹å‰æ²¡æœ‰è¿™ç±»æµ‹è¯•çš„é¡¹ç›®æ›´å¥½åœ°æ¸è¿›å¼å¯¼å…¥ï¼Œæ¯”è¾ƒé€‚åˆå†å²åŒ…è¢±è¾ƒé‡çš„é¡¹ç›®ã€‚
  * è´Ÿè´£å…¨å±€çŠ¶æ€ç®¡ç†çš„action/reduceræœ‰äº†æ›´è½»é‡çº§çš„React Hookså’ŒReact Contextå› è€Œä¸å†æ˜¯å¿…é€‰é¡¹äº†ï¼›
  * è´Ÿè´£æ´¾ç”Ÿæ•°æ®è®¡ç®—çš„selectorä¸€éƒ¨åˆ†å¯ä»¥æŒªåˆ°hooksé‡Œå¤´ï¼Œä¸€éƒ¨åˆ†å¯ä»¥åˆå¹¶åˆ°UIç»„ä»¶å†…éƒ¨ä½¿ç”¨`useMemo`ç­‰ï¼Œè¿™å±‚ä¹Ÿæ²¡æœ‰äº†ï¼›
  * è´Ÿè´£å‰¯ä½œç”¨ç®¡ç†/ç¼–æ’çš„saga/thunkè¿™å—ï¼Œå…¶ä¸»è¦éƒ¨åˆ†çš„APIç®¡ç†åŠå…¶ä»–éƒ¨åˆ†éƒ½å¯ä»¥åˆå¹¶åˆ°hooksé‡Œå¤´ï¼Œè¿™å±‚ä¹Ÿå¯ä»¥æ²¡æœ‰äº†ï¼›
  * ç»„ä»¶å±‚ï¼ŒåŸæ¥çš„ç­–ç•¥æ˜¯åªæµ‹é€»è¾‘ï¼Œæ–°ç­–ç•¥ä¸­å»ºè®®æ˜¯æ‹‰é€šhooksä¸€èµ·æµ‹ï¼Œå¹¶ä¸”è¦æµ‹è¯•é¡µé¢å†…å®¹ã€‚è¿™æ˜¯æœ¬ç¯‡æœ€å¤§çš„å˜åŒ–ï¼ˆå’Œç²¾åï¼‰ã€‚
* â€œ(å•å…ƒ)æµ‹è¯•è½åœ°â€è¿™éƒ¨åˆ†ï¼Œæœ¬ç¯‡ç»™å‡ºäº†å¤§é‡åŸºäºæ–°çš„å•å…ƒæµ‹è¯•ç­–ç•¥çš„ä»£ç ã€‚

## ä»€ä¹ˆæ˜¯æ— æ•ˆçš„è‡ªåŠ¨åŒ–æµ‹è¯•ï¼Ÿ/ ä»€ä¹ˆæ˜¯æœ‰æ•ˆçš„è‡ªåŠ¨åŒ–æµ‹è¯•ï¼Ÿ

é‚£ä¹ˆï¼Œä»€ä¹ˆæ˜¯æœ‰æ•ˆçš„è‡ªåŠ¨åŒ–æµ‹è¯•å‘¢ï¼Ÿ

* æ”¯æ’‘é‡æ„
* 

> ğŸš§ä»ä¸Šä¸€ç¯‡æŠ„ä¸€äº›è¿‡æ¥ã€‚

æ”¯æ’‘é‡æ„çš„æµ‹è¯•ä¸€ç›´æ˜¯æˆ‘å¼ºè°ƒçš„ä¸€ä¸ªæœ€æœ€é‡è¦çš„ç‚¹ã€‚ä¸èƒ½æ”¯æ’‘é‡æ„çš„æµ‹è¯•è¿˜ç•™ç€è¿‡å¹´å—ï¼Ÿé‚£ä¹ˆä»€ä¹ˆå«æ”¯æ’‘é‡æ„çš„æµ‹è¯•å‘¢ï¼Ÿ

* ä¸å½“å‰æµ‹è¯•ç›¸å…³çš„åŠŸèƒ½ç‚¹å˜åŒ–äº†/æ”¹åäº†ï¼Œå½“å‰æµ‹è¯•å¿…é¡»å¤±è´¥
* ä¸å½“å‰æµ‹è¯•ç›¸å…³çš„åŠŸèƒ½ç‚¹æ²¡å˜åŒ–/æ²¡æ”¹åï¼Œä½†æ˜¯å†…åœ¨çš„å®ç°ç»†èŠ‚æ”¹å˜äº†ï¼Œå½“å‰æµ‹è¯•å¿…é¡»ä»ç„¶é€šè¿‡
* ä¸å½“å‰æµ‹è¯•æ— å…³çš„åŠŸèƒ½ç‚¹å˜åŒ–äº†/æ”¹åäº†ï¼Œå½“å‰æµ‹è¯•å¿…é¡»ä»ç„¶é€šè¿‡ï¼Œå¿…é¡»æœ‰å…¶ä»–æµ‹è¯•å¤±è´¥

è¿™ä¹ˆè¯´æ˜¯æŒºæŠ½è±¡çš„ã€‚æˆ‘ä»¬ç›´æ¥æ¥ä¸Šæ‰‹çœ‹å‡ ä¸ªä¾‹å­ã€‚

* æ–­è¨€ç»†èŠ‚ä¸æµ‹è¯•æ„å›¾ç›¸å·®å¤ªè¿œï¼šä¸å¥½è°ƒè¯•ã€ä¸å¥½ç†è§£ã€æŒ‚äº†ä¸çŸ¥é“å’‹å›äº‹ã€ç•™ä¸ä½ä¸šåŠ¡ä¸Šä¸‹æ–‡ï¼Œé™¤äº†åˆ·è¦†ç›–ç‡ï¼Œå¯¹å®é™…çš„ä»£ç è´¨é‡ã€ç¨³å®šæ€§ã€åç»­ç»´æŠ¤åŸºæœ¬æ˜¯æ‹–åè…¿çš„çŠ¶æ€ã€‚
  * ä¸åšç²¾å‡†æ–­è¨€ï¼Œæ»¡ç¯‡éƒ½æ˜¯`expect('ä¸€äº›å­—ç¬¦').toBeInTheDocument()`ã€‚<æœ‰å•¥é—®é¢˜ï¼Ÿâ‘ å­—å¦‚æœæ˜¯åŒæ ·çš„/è¿‡äºæ™®éï¼ˆæ¯”å¦‚æ–­è¨€$20åº”è¯¥åœ¨é¡µé¢ä¸Šï¼Œé¬¼çŸ¥é“è¿™å•¥æ„æ€ï¼Ÿå†è€…å‡è®¾ä½ æ˜¯è¿™ä¹ˆä¸ªåº”ç”¨ï¼Œæœˆä»˜$20ï¼Œå¹´ä»˜åªè¦$208(-32/â†“15%)ï¼Œä½ æ–­è¨€æœˆä»˜ä½†å…¶å®å¹´ä»˜ä¹Ÿæœ‰$20ï¼Œä½ æ”¹åäº†æœˆä»˜ï¼Œå¹´ä»˜è¿˜åœ¨å‘¢ï¼Œæµ‹è¯•ä¸ä¼šæŒ‚ï¼Œä½†æ˜¯ä½ çš„åŠŸèƒ½åäº†ã€‚è¿™å°±æ˜¯æ‰€è°“ä¸æ”¯æŒé‡æ„çš„æµ‹è¯•ï¼‰ï¼Œå“ªå“ªéƒ½æœ‰ï¼Œèµ·ä¸åˆ°æµ‹è¯•æ•ˆæœï¼›â‘¡çœ‹äº†å°±ç”Ÿæ°”ï¼Œæµ‹çš„è¿™æ˜¯å•¥ï¼›â‘¢ä¸æ”¯æŒé‡æ„>
  * æ–­è¨€å¤ªå¤šç»†èŠ‚ï¼Œæ¯”å¦‚æŸä¸ªactionæœ‰æ²¡æœ‰dispatchã€æŸä¸ªmockæ˜¯ä¸æ˜¯ç¬¬næ¬¡è¢«è°ƒç”¨çš„æ—¶å€™æ˜¯æŸä¸ªå‚æ•°ã€‚<æœ‰å•¥é—®é¢˜ï¼Ÿ>

> ğŸš§ä»ä»£ç åº“é‡Œè¡¥ç‚¹ä¾‹å­ã€‚

## Reactåº”ç”¨çš„å¸¸è§æ¶æ„ ä¸ æµ‹è¯•ç­–ç•¥

> ğŸš§ ~~ä¼—æ‰€å‘¨çŸ¥ï¼Œ~~æµ‹è¯•ç­–ç•¥æ˜¯ä»åº”ç”¨æ¶æ„ä¸­æ¥çš„ã€‚å¯¹äºä¸€ä¸ªReactåº”ç”¨æ¥è¯´ï¼Œé™¤äº†UIç»„ä»¶ä¹‹å¤–ï¼Œè¿˜ä¼šæœ‰å…¨å±€çŠ¶æ€ç®¡ç†ï¼ˆreduxé‚£å¥—ï¼Œaction+reducerï¼‰ã€å‰¯ä½œç”¨ç®¡ç†ï¼ˆredux-thunkã€sagaã€redux-observableé‚£å¥—ï¼‰ç­‰ä¸œè¥¿ï¼Œåœ¨æ–°çš„Reactç‰ˆæœ¬é‡Œï¼ŒçŠ¶æ€ç®¡ç†å·²ç»åŸºæœ¬å¯ä»¥è¢«æ›´è½»é‡çº§çš„React Contextå–ä»£ï¼Œå‰¯ä½œç”¨ç®¡ç†çš„å¤§å¤´ã€APIè¯·æ±‚ä¹Ÿå·²ç»å¯ä»¥è¢«React Queryè¿™æ ·é›†æˆäº†å…¨å±€çŠ¶æ€ç®¡ç†åŠŸèƒ½çš„queryåº“å–ä»£ã€‚æ–°æ¶æ„å¦‚ä¸‹å›¾ï¼š
> 
> ğŸš§æ¶æ„å›¾æ¶¦è‰²ä¸€ä¸‹ï¼ŒMermaidå†™ç€çˆ½ï¼Œçœ‹ç€ä¸‘ã€‚

```mermaid
flowchart TB
  route([<b>Routes / Route Components</b><br>Next.js app/, React Router, ..])
  ui_components([UI Components])
  shared_hooks([<b>Other share hooks</b>])
  api([<b>API Client</b><br/>React Query, axios,  ..])
  dom_effects([<b>DOM APIs</b><br/>window events, etc.])
  analytics([<b>Analytics</b><br/>Sentry, Adobe Analytics, ..])
  global_store([<b>Global store</b><br/>React Context, redux, mobx, ..])
    
  utils([<b>Utils</b>])
  constants([<b>Constants</b>])

  component_index[index.tsx]
  component_types[types.ts]
  component_hooks[hooks.ts]
  component_sub_components["components/<br/><br/>    index.tsx<br/>    types.ts<br/>    ..."]

  subgraph page_components [Page Components]
    direction TB
    component_index
    component_types
    component_hooks
    component_sub_components

    component_index --> component_types
    component_index --> component_hooks
    component_index --> component_sub_components
  end
  
  route --> components
  subgraph components [React Components]; 
    page_components
    ui_components
    page_components --> ui_components
  end
  
  components --> hooks
  route -.-> hooks
  subgraph hooks [Hooks Layer];
    direction TB
    shared_hooks
    api
    dom_effects
    analytics
    global_store
  end
  
  subgraph tools [Shared Layer]
    direction TB
    utils
    constants

    %% this can happen too
    utils -.-> constants
  end
  
  hooks --> tools
  %%  this can happen, but just to make the layers more explicit
  %%components --> tools
  route -.-> tools
```

> ğŸš§æ•´ä¸ªåº”ç”¨é—´çš„æµ‹è¯•ç­–ç•¥ã€ä¹ƒè‡³äºæ•´ä¸ªæ¶æ„ï¼ˆè¿›ç¨‹é—´ï¼‰çš„æµ‹è¯•ç­–ç•¥ï¼Œæˆ‘æ”¾åˆ°[ä¸‹ä¸€éƒ¨åˆ†ï¼šReactæµ‹è¯•ç­–ç•¥ä¸è½åœ°ï¼ˆä¸‰ï¼‰][react-testing-strategy-best-practice]æ¥é˜è¿°ã€‚æœ¬ç¯‡çš„åç»­éƒ¨åˆ†ï¼Œæˆ‘ä»¬æ¥è°ˆè°ˆUIç»„ä»¶è¿™éƒ¨åˆ†å•å…ƒæµ‹è¯•çš„æœ€ä½³å®è·µã€‚
> 
> åœ¨Reactå’Œå‰ç«¯è¿™ä¸ªä¸Šä¸‹æ–‡ä¸­ï¼Œå•å…ƒæµ‹è¯•ä¸æ˜¯æœ€ä¼˜è§£â€”â€”è¿™ä¹Ÿæ˜¯æˆ‘ä¸Šä¸€ç‰ˆæµ‹è¯•ç­–ç•¥æ¨èå¯¹ç»„ä»¶çš„æµ‹è¯•æ–¹å¼â€”â€”é›†æˆå¼çš„å•å…ƒæµ‹è¯•æ‰æ˜¯ã€‚å®ƒæœ‰ä¸€äº›ç¼ºç‚¹ï¼šğŸš§ï¼ˆä»€ä¹ˆç¼ºç‚¹ï¼‰ã€‚ğŸš§ï¼ˆè®²ä¸€ä¸‹é‚£ä»€ä¹ˆæ‰æ˜¯æœ€ä¼˜è§£ï¼‰ã€‚
> 
> è®²ä¸€ä¸‹é»‘é©¬é‡Œå…³äºå‘ç°é—®é¢˜çš„æµ‹è¯•å’Œå®šä½é—®é¢˜çš„æµ‹è¯•ã€‚
> 
> ä½†æˆ‘æ— æ„å‘æ˜æ–°çš„åè¯ï¼Œå› æ­¤ï¼Œæœ¬æ–‡æ‰€éœ€çš„åªæ˜¯ä¸€ä¸ªç”¨æ¥æŒ‡ä»£æœ¬æ–‡è¿™æ ·ä¸€ç§æµ‹è¯•æ–¹å¼çš„æŒ‡ç§°ã€‚

* hookï¼šhookçš„å•å…ƒæµ‹è¯•
* å…¶ä»–å±‚çš„æµ‹è¯•ï¼šå¥‘çº¦æµ‹è¯•
* ä½¿ç”¨React Queryç­‰global statement managementçš„åº“
* å…¶ä»–hookçš„æµ‹è¯•ï¼šå‰¯ä½œç”¨ï¼Œå¦‚windowsã€åŸ‹ç‚¹ç­‰ã€‚

## æµ‹è¯•æ¶æ„ã€ä»£ç è½åœ°

* æµ‹è¯•ä»£ç æ¶æ„ï¼šAPI DSLï¼ˆæ–¹ä¾¿çš„API mockè¯­æ³•ï¼‰+Fixtureï¼ˆmockæ•°æ®ï¼‰+testerï¼ˆé€‰æ‹©å™¨ï¼‰+expectationsï¼ˆæµ‹è¯•æ–­è¨€ï¼‰
* API mock & DSL
* ç»„ä»¶å±‚testeræ²‰æ·€å’ŒAPIè®¾è®¡
* æµ‹è¯•ä¸»ä½“
  * UIå†…å®¹æ–­è¨€
  * ç”¨æˆ·è¡Œä¸ºäº¤äº’
  * API Mock

```typescript
interface DropdownTester {
  getLabel(): string;
  getValue(): string;
  getDisplayText(): string;
}

export const findDropdown = (testId: string): DropdownTester => {
  const getElement = () => screen.getByTestId(testId)
  const getLabel = () => screen.getByTestId(`${testId}-dropdown-label`).textContent 
  const getValue = () => screen.getByTestId(`${testId}-dropdown-input`).getAttribute('value') 
  const getDisplayText = () => { return /* ... */ }

  return { getLabel, getValue, getDisplayText }
}
```

## è¡ç”Ÿé—®é¢˜

ğŸš§æ–½å·¥ä¸­ã€‚

* ä»¥ä»€ä¹ˆä¸ºâ€œé¡µé¢â€/å•ä½ï¼Ÿè·¯ç”±æˆ–é¡µé¢ç»„ä»¶ï¼ˆPage componentï¼‰
* è·¨â€œé¡µé¢â€çš„åŠŸèƒ½ï¼ˆæ¯”å¦‚ç”¨æˆ·æ”¹å˜äº†è·¯ç”±ã€è·³åˆ°äº†å¦ä¸€ä¸ªé¡µé¢çš„ä¸€äº›åŠŸèƒ½ç­‰ï¼‰ï¼Œç”¨ä¸ç”¨è¿™å¥—ä¸œè¥¿æµ‹ï¼Ÿ
* æµ‹è¯•æ–‡ä»¶è¿‡é•¿ï¼šæŠ½å‡½æ•°ã€æ”¾å¼ƒä¸å¿…è¦çš„æ–­è¨€
* æµ‹è¯•æ–‡ä»¶å¦‚ä½•ç»„ç»‡ï¼š
  * ä»¥åŠŸèƒ½ç»„ç»‡ï¼Œå†™çš„æ—¶å€™å¯èƒ½è·¨å¥½å‡ ä¸ª`describe`/æ–‡ä»¶ï¼Œéš¾ä»¥å‘ç°ã€éš¾ä»¥ç»´æŠ¤ï¼›
  * ä»¥é¡µé¢ç»„ç»‡ï¼Œå®¹æ˜“å¾ˆåˆ†æ•£ï¼Œçœ‹ä¸å‡ºä¸šåŠ¡é€»è¾‘ã€‚
* å¦‚ä½•debugï¼Ÿ

## æ€»ç»“ï¼šä¼˜åŠ¿ & æŒ‘æˆ˜

ğŸš§æ–½å·¥ä¸­ã€‚

æœ‰ä»€ä¹ˆå¥½å¤„ï¼Ÿ

* æ”¯æŒé‡æ„ï¼šæ”¹åŠŸèƒ½æ—¶æµ‹è¯•èƒ½æœ‰æ•ˆä¿éšœè¡Œä¸ºã€ä¸éœ€è¦æ”¹åŠ¨ç›¸åº”çš„æµ‹è¯•ï¼›
* è¶Šå†™è¶Šé¡ºæ‰‹ï¼Œç»„åˆå¼ï¼Œå†™æ–°æµ‹è¯•ç›¸å½“å®¹æ˜“ï¼›
* æµ‹è¯•æ–­è¨€å£°æ˜å¼ï¼Œæœ‰æ•ˆç•™å­˜ä¸šåŠ¡ä¸Šä¸‹æ–‡ã€‚

æŒ‘æˆ˜æ˜¯ä»€ä¹ˆï¼šä¸€ä¸ªæœ‰æ•ˆçš„æµ‹è¯•ç­–ç•¥ï¼Œä»¥åŠç¼–å†™æµ‹è¯•çš„èƒ½åŠ›ï¼Œæ¥ç®¡ç†è¿™äº›å¼€å‘æˆæœ¬ã€ç»´æŠ¤æˆæœ¬ã€‚

* æœ‰ä¸€å®šçš„å¼€å‘æˆæœ¬â€”â€”ç›¸æ¯”çº¯å‡½æ•°è€Œè¨€ã€‚
* æœ‰ä¸€å®šçš„ç»´æŠ¤æˆæœ¬â€”â€”éœ€è¦ä¿è¯æµ‹è¯•é—´ç‹¬ç«‹æ€§ï¼ˆå› ä¸ºå¼•å…¥äº†API mockè€Œä¸æ˜¯ç»„ä»¶çº§åˆ«çš„mockï¼‰ã€ç­‰
* å®šä½é—®é¢˜çš„èƒ½åŠ›ç›¸å¯¹â€œç»å¯¹çš„å•å…ƒæµ‹è¯•â€æœ‰æ‰€é™ä½ã€‚

## Q & A

> ğŸš§Q & Aä¹Ÿæ­£åœ¨æ–½å·¥ä¸­ã€‚æ¬¢è¿è·Ÿä½œè€…å…ˆæœŸæå‡ºä½ çš„å®è·µå›°æƒ‘ï¼š[linesh.simpcity@gmail.com](mailto:linesh.simpcity@gmail.com)ã€‚

> é—®é¢˜ï¼šä¸ºä»€ä¹ˆé‡‡ç”¨é›†æˆå¼æµ‹è¯•ç»„ä»¶çš„ç­–ç•¥ï¼ŸMVVMåˆ†ç¦»ä¸ºä»€ä¹ˆä¸è¡Œï¼Ÿ
 
å›ç­”ï¼šä¸å®é™…ã€‚æœ‰äº†Hooksä»¥åï¼Œç°ä»£Reactç»„ä»¶å…¶å®å°±æ˜¯ä¸ªç»„åˆæ‰€æœ‰é€»è¾‘çš„åœ°æ–¹ï¼Œæ‰€æœ‰åè°ƒéƒ½åœ¨è¿™é‡Œã€‚

## References 

* testing pyramid 
* series from Jimmy

[^automated-tests-for-enterprise-only]: å¯¹äºä¸ªäººé¡¹ç›®ï¼Œè‡ªåŠ¨åŒ–æµ‹è¯•ä¹ƒè‡³TDDå®è·µæ˜¯å¦å¿…é¡»åªè·Ÿç»´æŠ¤æœ‰å…³ï¼Œä½ è‡ªå·±å¼€å¿ƒå°±è¡Œã€‚

[reactå•å…ƒæµ‹è¯•ç­–ç•¥]: https://ethan.thoughtworkers.me/#/post/2018-07-13-react-unit-testing-strategy
[react-testing-strategy-best-practice]: https://ethan.thoughtworkers.me
